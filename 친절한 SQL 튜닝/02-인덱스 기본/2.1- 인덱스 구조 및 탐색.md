# 튜닝 - 인덱스 스캔 효율화 VS 랜덤 액세스 최소화

## 1. 개요

데이터베이스 쿼리 튜닝에서 인덱스 스캔은 중요한 요소이지만, 실제 성능에 더 큰 영향을 주는 것은 랜덤 액세스의 수를 줄이는 것이다. 본 문서는 그 이유와 실전 사례를 정리한다.

---

## 2. 기본 개념

### 2.1 인덱스 스캔

인덱스를 활용하여 원하는 레코드를 찾는 과정이다. 인덱스는 정렬되어 있어 탐색 비용이 낮다.

### 2.2 랜덤 액세스

인덱스로 찾아낸 레코드의 실제 데이터(ROW)를 테이블에서 가져오는 과정이다. 디스크 또는 버퍼에서 위치가 분산되어 있어서 비용이 크다.

---

## 3. 랜덤 액세스가 더 중요한 이유

### 3.1 랜덤 액세스 비용이 압도적으로 크기 때문이다

인덱스 스캔은 순차적 접근이 많아 비용이 낮다. 반면 랜덤 액세스는 다음과 같은 이유로 비용이 커진다.

* 테이블 페이지가 디스크 여러 곳에 흩어져 있다.
* 매 ROW마다 IO가 발생할 수 있다.
* 버퍼 캐시 적중률이 낮으면 실제 디스크 IO가 발생한다.

### 3.2 인덱스 스캔 자체는 빠르지만 테이블 액세스에서 병목이 발생한다

인덱스로 100개를 찾아도, 그 100개의 ROW를 테이블에서 랜덤하게 읽으면 시간이 많이 걸린다.

### 3.3 테이블이 클수록 랜덤 액세스 비용이 기하급수적으로 증가한다

테이블이 커지면 페이지가 여러 파일 블록에 퍼지고, 접근 지연이 더 커진다.

---

## 4. 실전 예시

### 4.1 인덱스 스캔은 적지만 랜덤 액세스가 많은 경우

```
SELECT *
FROM orders
WHERE customer_id IN (1000개의 값)
```

* 인덱스로 customer_id를 탐색 → 비용 낮음
* 하지만 1000개의 ROW를 테이블에서 랜덤 읽기 → 비용 높음

### 4.2 커버링 인덱스가 빠른 이유

실제 테이블을 읽지 않아서 랜덤 액세스가 없다. 이 때문에 커버링 인덱스는 매우 빠른 실행이 가능하다.

---

## 5. 튜닝 원칙

### 5.1 랜덤 액세스를 먼저 줄여라

* 가능하면 커버링 인덱스 구조로 개선
* 불필요한 SELECT * 제거
* 제공받는 컬럼을 최소화

### 5.2 인덱스 스캔 개선은 그 다음 문제

* 인덱스의 선택도 개선
* 범위 스캔을 줄이는 방향으로 개선
* 불필요한 조건 제거

---

## 6. 결론

인덱스 스캔은 상대적으로 비용이 낮지만, 랜덤 액세스는 시스템 IO를 직접적으로 증가시키는 고비용 작업이다. 따라서 데이터베이스 튜닝에서는 인덱스 구조를 개선하는 것보다 랜덤 액세스 자체를 줄이는 전략이 훨씬 더 중요한 기준이 된다.
