
## 비상태 프로토콜(Stateless Protocol)

비상태 프로토콜은 서버가 클라이언트의 이전 요청에 대한 정보를 저장하지 않는 프로토콜.     
각 요청은 독립적으로 처리되며, 서버는 요청 간의 관계나 이전 상태를 기억하지 않는다.

특징:
- 각 요청이 완전히 독립적
- 서버가 세션 정보를 유지하지 않음
- 확장성이 좋음 (서버 간 부하 분산이 용이)
- 예: HTTP (기본적으로)

## 상태 프로토콜(Stateful Protocol)

상태 프로토콜은 서버가 클라이언트와의 연결 상태 및 이전 트랜잭션 정보를 유지하는 프로토콜.

특징:
- 연결이 유지되는 동안 상태 정보 보존
- 이전 명령/응답을 기억함
- 세션 기반 작동

## 이메일 프로토콜 비교

### SMTP (Simple Mail Transfer Protocol) - 메일 전송
상태 프로토콜
- 메일 전송 세션 동안 연결을 유지
- HELO/EHLO로 세션 시작, QUIT로 종료
- 한 세션 내에서 여러 명령이 순차적으로 처리됨
- 포트: 25, 587 (TLS)

### POP3 (Post Office Protocol version 3) - 메일 수신
상태 프로토콜
- 세 가지 상태를 가짐: Authorization(인증), Transaction(트랜잭션), Update(업데이트)
- 각 상태에서 사용 가능한 명령이 다름
- 로그인 후 메일함을 잠그고(lock) 세션 종료 시 변경사항 반영
- 기본적으로 메일을 다운로드 후 서버에서 삭제 (설정 변경 가능)
- 포트: 110, 995 (SSL/TLS)

POP3의 세 가지 상태:
1. Authorization: USER, PASS 명령으로 인증
2. Transaction: STAT, LIST, RETR, DELE 등으로 메일 조회/삭제
3. Update: QUIT 명령 시 삭제 표시된 메일을 실제로 삭제

### IMAP (Internet Message Access Protocol) - 메일 수신
상태 프로토콜
- 가장 복잡한 상태 관리를 수행
- 클라이언트가 로그인한 후 세션 상태를 유지
- 선택된 메일함, 읽은/안 읽은 상태 등을 서버가 기억
- 메일을 서버에 보관하며 여러 기기에서 동기화 가능
- 메일함(폴더) 구조를 서버에서 관리
- 포트: 143, 993 (SSL/TLS)

## 요약

SMTP, POP3, IMAP 모두 상태 프로토콜. 세 프로토콜 모두:
- 클라이언트-서버 간 연결 세션을 유지
- 세션 내에서 상태 정보를 기억
- 특정 상태에서만 실행 가능한 명령이 있음
- 명령의 순서와 맥락이 중요함

주요 차이점:
- SMTP: 메일을 "보내는" 프로토콜
- POP3: 메일을 "다운로드"하는 프로토콜 (간단, 오프라인 중심)
- IMAP: 메일을 "관리"하는 프로토콜 (복잡, 동기화 중심)

## 이메일 프로토콜 비교표

| 구분 | SMTP | POP3 | IMAP |
|------|------|------|------|
| 전체 이름 | Simple Mail Transfer Protocol | Post Office Protocol version 3 | Internet Message Access Protocol |
| 주요 용도 | 메일 전송 (송신) | 메일 수신 (다운로드) | 메일 수신 (관리) |
| 프로토콜 유형 | 상태 프로토콜 (Stateful) | 상태 프로토콜 (Stateful) | 상태 프로토콜 (Stateful) |
| 기본 포트 | 25 (일반), 587 (TLS) | 110 (일반), 995 (SSL/TLS) | 143 (일반), 993 (SSL/TLS) |
| 메일 저장 위치 | - | 클라이언트 (로컬) | 서버 |
| 메일 동기화 | - | 불가능 | 가능 (여러 기기 간) |
| 오프라인 접근 | - | 용이 (다운로드 후) | 제한적 (캐시 의존) |
| 서버 저장공간 | - | 절약 (다운로드 후 삭제) | 많이 사용 |
| 폴더/메일함 관리 | - | 불가능 | 가능 (서버 측 폴더) |
| 메일 상태 관리 | - | 제한적 | 상세 (읽음/안읽음/플래그 등) |
| 주요 명령어 | HELO/EHLO, MAIL FROM, RCPT TO, DATA, QUIT | USER, PASS, STAT, LIST, RETR, DELE, QUIT | LOGIN, SELECT, FETCH, STORE, SEARCH, CREATE |
| 세션 상태 | 연결 → 전송 → 종료 | Authorization → Transaction → Update | Not Authenticated → Authenticated → Selected → Logout |
| 대역폭 사용 | 메일 크기에 비례 | 전체 메일 다운로드 (높음) | 필요한 부분만 (효율적) |
| 복잡도 | 중간 | 단순 | 복잡 |
| 첨부파일 처리 | 전송 시 인코딩 | 전체 다운로드 | 선택적 다운로드 가능 |
| 검색 기능 | - | 없음 (클라이언트에서 처리) | 있음 (서버 측 검색) |
| 다중 기기 사용 | - | 부적합 | 적합 |
| 네트워크 의존성 | 전송 시 필요 | 다운로드 시만 필요 | 항상 필요 (조회 시) |
| 메일 백업 | - | 클라이언트 책임 | 서버에 자동 보관 |
| 일반적 사용 시나리오 | 메일 발송, 서버 간 전달 | 단일 기기, 오프라인 작업 | 다중 기기, 클라우드 기반 |
| 장점 | 표준화, 안정적 전송 | 단순, 빠름, 오프라인 가능 | 동기화, 유연한 관리, 서버 백업 |
| 단점 | 스팸에 취약 | 동기화 불가, 서버 백업 없음 | 복잡, 네트워크 의존, 서버 공간 필요 |

## 실제 사용 예시

현실에서는 아래 조합이 사실상 표준이다.

---

# 현실에서 가장 많이 쓰는 이메일 프로토콜 조합

## 1) SMTP + IMAP

현대 이메일 서비스(네이버, 구글, 지메일, 아웃룩 등)의 기본 구조이다.

 메일 보낼 때 → SMTP
 메일 받고 관리할 때 → IMAP

왜 이 조합이 표준인가?

1. 여러 기기(PC·스마트폰·태블릿) 간 동기화가 완벽하다.
2. 읽음/삭제/폴더 이동 등이 서버 중심으로 유지된다.
3. 클라이언트는 서버의 상태를 그대로 반영하므로 사용성이 좋다.

→ 일반 사용자, 기업, 모바일 환경에서 가장 보편적이다.

---

# 현실에서 POP3는 왜 잘 안 쓰일까?

POP3는 예전에는 흔했지만 지금은 드물다.
이유는 다음과 같다:

1. 기본 동작이 “다운로드 후 서버 삭제”라서
   여러 기기에서 메일을 보기에 불편함.
2. 서버 상태와 클라이언트 상태가 분리되어
   동기화가 되지 않는다.
3. 현대 모바일·웹메일 환경과 맞지 않는다.

→ 일부 기업의 레거시 시스템이나 오래된 메일 클라이언트에서만 사용되는 수준이다.

---

# 현실 사용 비율 요약

| 기능       | 실제 표준 프로토콜 | 비고              |
| -------- | ---------- | --------------- |
| 메일 보내기   | SMTP   | 거의 100%         |
| 메일 받기/관리 | IMAP   | 업계 표준, 모바일·웹 중심 |
| 레거시 환경   | POP3       | 드물게 사용됨         |

---

# 결론

실제 현실에서는 SMTP와 IMAP 조합이 거의 모든 이메일 서비스에서 사용된다.
POP3는 현대 환경에서는 거의 대체되었다.

필요하면 “SMTP → MTA → IMAP 구조”를 전체 흐름도로 정리해줄 수 있다.


